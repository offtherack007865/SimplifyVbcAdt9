IF EXISTS (SELECT * FROM sys.objects WHERE type = 'P' AND OBJECT_ID = OBJECT_ID('dbo.spFinalizeHumanaObsRaw'))
   drop proc [dbo].[spFinalizeHumanaObsRaw]
GO
CREATE PROCEDURE [dbo].[spFinalizeHumanaObsRaw] 
AS
BEGIN

  declare @myCurrentDateTime [datetime]
  set @myCurrentDateTime = getdate()
  
  truncate table [dbo].[HumanaObsMaster];
  insert into [dbo].[HumanaObsMaster]
  (
     [RptDt]
	,[Type]
	,[Group]
	,[GrouperName]
	,[FacDbName]
	,[PcpName]
	,[CaseType]
	,[AuthId]
	,[FirstDay]
	,[SubscriberId]
	,[FirstName]
	,[LastName]
	,[DateOfBirth]
	,[GrouperId]
	,[PcpId]
	,[FaxTaxId]
	,[AuthType]
	,[RequestType]
	,[NotifDate]
	,[LastDay]
	,[DiagCode1]
	,[DiagDesc1]
	,[DiagCode2]
	,[DiagDesc2]
	,[DiagCode3]
	,[DiagDesc3]
	,[ProcCode]
	,[ProcDesc]
	,[Gender]
	
	,[SourceFullFilename]
	,[LastUpdateTimestamp]
  )
  select
    [RptDt]
	,[Type]
	,[Group]
	,[GrouperName]
	,[FacDbName]
	,[PcpName]
	,[CaseType]
	,[AuthId]
	,[FirstDay]
	,[SubscriberId]
	,[FirstName]
	,[LastName]
	,[DateOfBirth]
	,[GrouperId]
	,[PcpId]
	,[FaxTaxId]
	,[AuthType]
	,[RequestType]
	,[NotifDate]
	,[LastDay]
	,[DiagCode1]
	,[DiagDesc1]
	,[DiagCode2]
	,[DiagDesc2]
	,[DiagCode3]
	,[DiagDesc3]
	,[ProcCode]
	,[ProcDesc]
	,[Gender]
	
	,[SourceFullFilename]
	,[LastUpdateTimestamp]
  
  from [dbo].[HumanaObsRaw]

  truncate table [dbo].[HumanaObsRaw];
   
  declare @HumanaObsMasterCount [int] = 0  
  select @HumanaObsMasterCount = count(*)
    from [dbo].[HumanaObsMaster]
	
  declare @IsOk [bit]
  
  if (@HumanaObsMasterCount > 0) begin
    set @IsOk = 1
  end
  else begin
    set @IsOk = 1
  end
   
  select @IsOk [IsOk]   
   
END  